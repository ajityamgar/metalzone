{% extends 'base.html' %}
{% block title %}My Addresses - Metal Zone{% endblock %}
{% block meta_description %}Manage your shipping addresses at Metal Zone. Add, edit, or delete addresses for faster checkout.{% endblock %}
{% block robots %}noindex, nofollow{% endblock %}
{% block content %}
<section class="section" style="background: #f9f9f9; padding: 2rem 0;">
    <div class="container narrow center">
        <h1 style="font-size: 2.5rem; margin-bottom: 0.5rem;">My Addresses</h1>
        <p>Manage your shipping addresses</p>
    </div>
</section>

<section class="section">
    <div class="container" style="max-width: 800px;">
        <div class="panel" style="background: white; padding: 2rem; border-radius: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); margin-bottom: 2rem;">
            <h2 style="margin-bottom: 1.5rem;">Add New Address</h2>
            <form method="POST">
                {{ form.hidden_tag() }}
                {{ form.address_id() }}
                
                <div class="form-row">
                    <label>Full Name *</label>
                    {{ form.name(class="form-control") }}
                </div>
                
                <div class="form-row">
                    <label>Mobile Number *</label>
                    {{ form.mobile(class="form-control") }}
                </div>
                
                <div class="form-row">
                    <label>Address Line 1 *</label>
                    {{ form.address_line1(class="form-control") }}
                </div>
                
                <div class="form-row">
                    <label>Address Line 2 (Optional)</label>
                    {{ form.address_line2(class="form-control") }}
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div class="form-row">
                        <label>City *</label>
                        {{ form.city(class="form-control") }}
                    </div>
                    <div class="form-row">
                        <label>State *</label>
                        {{ form.state(class="form-control") }}
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div class="form-row">
                        <label>Pincode *</label>
                        {{ form.pincode(class="form-control") }}
                    </div>
                    <div class="form-row">
                        <label>Country</label>
                        {{ form.country(class="form-control") }}
                    </div>
                </div>
                
                <div class="form-row">
                    <label>Address Type</label>
                    {{ form.address_type(class="form-control") }}
                </div>
                
                <div class="form-row">
                    <label>
                        {{ form.is_default() }} Set as default address
                    </label>
                </div>
                
                <button class="btn primary" type="submit">Save Address</button>
            </form>
        </div>
        
        {% if addresses %}
            <h2 style="margin-bottom: 1.5rem;">Saved Addresses</h2>
            <div style="display: flex; flex-direction: column; gap: 1rem;">
                {% for address in addresses %}
                    <div class="panel" style="background: white; padding: 1.5rem; border-radius: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); {% if address.is_default %}border: 2px solid var(--header-bg);{% endif %}">
                        <div style="display: flex; justify-content: space-between; align-items: start;">
                            <div>
                                {% if address.is_default %}
                                    <span style="padding: 0.25rem 0.75rem; background: var(--header-bg); color: white; border-radius: 999px; font-size: 0.8rem; font-weight: 600; margin-bottom: 0.5rem; display: inline-block;">Default</span>
                                {% endif %}
                                <h3 style="margin: 0.5rem 0;">{{ address.name }}</h3>
                                <p style="color: #666; margin: 0.25rem 0;">{{ address.mobile }}</p>
                                <p style="color: #666; margin: 0.5rem 0; line-height: 1.6;">
                                    {{ address.address_line1 }}<br>
                                    {% if address.address_line2 %}{{ address.address_line2 }}<br>{% endif %}
                                    {{ address.city }}, {{ address.state }} {{ address.pincode }}<br>
                                    {{ address.country }}
                                </p>
                                <p style="color: #999; font-size: 0.85rem; margin: 0.25rem 0; text-transform: capitalize;">{{ address.address_type }}</p>
                            </div>
                            <div style="display: flex; gap: 0.5rem;">
                                <form method="POST" action="{{ url_for('addresses') }}" style="margin: 0;">
                                    {{ form.hidden_tag() }}
                                    <input type="hidden" name="address_id" value="{{ address.id }}">
                                    <button type="submit" class="btn ghost" style="padding: 0.5rem 1rem; font-size: 0.9rem;">Edit</button>
                                </form>
                                <form method="POST" action="{{ url_for('address_delete', address_id=address.id) }}" style="margin: 0;">
                                    <button type="submit" class="btn ghost" style="padding: 0.5rem 1rem; font-size: 0.9rem; color: var(--danger);" onclick="return confirm('Are you sure you want to delete this address?')">Delete</button>
                                </form>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    </div>
</section>
{% endblock %}

